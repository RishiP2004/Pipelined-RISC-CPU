module EX_MEM_Register (
    input clk,                          // Clock signal
    input reset,                        // Reset signal
    
    // Inputs from Execute stage
    input [7:0] result_ex,              // Result from the Execute stage (ALU output)
    input load_enable_ex,               // Load enable from Execute stage
    input store_enable_ex,              // Store enable from Execute stage
    input [7:0] mem_addr_ex,            // Memory address from Execute stage
    input [7:0] reg_addr_ex,            // Register address for write-back

    // Outputs to Memory stage (only necessary signals)
    output reg [7:0] result_mem,        // Pass ALU result to MEM stage
    output reg load_enable_mem,         // Pass load enable signal to MEM stage
    output reg store_enable_mem,        // Pass store enable signal to MEM stage
    output reg [7:0] mem_addr_mem,      // Pass memory address to MEM stage

    // Bypassed signals for Writeback stage
    output reg [7:0] result_wb,         // Pass ALU result directly to WB stage
    output reg [7:0] reg_addr_wb,       // Pass reg address to WB stage
    output reg write_enable_wb          // Pass write enable signal to WB stage
);

    always @(posedge clk or posedge reset) begin
        if (reset) begin
            // Reset all outputs to default values
            result_mem <= 8'b00000000;
            load_enable_mem <= 1'b0;
            store_enable_mem <= 1'b0;
            mem_addr_mem <= 8'b00000000;

            // Bypassed signals also reset
            result_wb <= 8'b00000000;
            reg_addr_wb <= 8'b00000000;
            write_enable_wb <= 1'b0;
        end else begin
            // Pass only the needed values to the Memory stage
            result_mem <= result_ex;
            load_enable_mem <= load_enable_ex;
            store_enable_mem <= store_enable_ex;
            mem_addr_mem <= mem_addr_ex;

            // Pass directly to Writeback stage (bypassing Memory)
            result_wb <= result_ex;
            reg_addr_wb <= reg_addr_ex;
            write_enable_wb <= write_enable_ex;
        end
    end

endmodule
